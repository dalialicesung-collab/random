# **多元隨機座位表 (Ultimate Seating Chart) 使用說明書**

這是一個基於網頁技術 (HTML5 \+ Tailwind CSS \+ JavaScript) 開發的單一檔案應用程式，專為教學現場設計，解決複雜的分組與座位安排需求。

## **核心功能總覽**

1. **智慧名單解析**：支援 Excel 直接複製貼上，自動辨識 3 欄或 2 欄格式。  
2. **多元分組模式**：提供 5 種不同的桌型與排列組合（6、7、8、9、20 組）。  
3. **視覺化互動**：支援拖曳換位 (Drag & Drop) 與點擊點名。  
4. **場地模擬**：包含鎖定特定空位功能（模擬柱子或損壞桌椅）。  
5. **格式化匯出**：可輸出 Word 座位表（保留排版）與 Excel 名單（含缺席紀錄）。

## **詳細操作指令與邏輯**

### **第一步：輸入名單**

在「**步驟** 1 **貼上名單**」的文字框中輸入學生資料。程式內建智慧解析邏輯：

* **資料來源**：通常來自 Excel，欄位間以 Tab 或空格分隔。  
* **支援格式**：  
  1. **3 欄模式**：\[班級\] \[座號\] \[姓名\]  
     * *邏輯*：系統會自動提取數字，將座號補零至2位，組合成5碼學號（如：103班 5號 \-\> 10305）。  
  2. **2 欄模式 (座號+姓名)**：\[座號\] \[姓名\]  
     * *邏輯*：判斷第二欄為非數字文字，自動補零座號（如：5 王小明 \-\> 05）。  
  3. **2 欄模式 (班級+座號)**：\[班級\] \[座號\]  
     * *邏輯*：判斷第二欄為純數字，姓名欄位自動填入預設值「同學」。

### **第二步：選擇組別模式**

在「**步驟 2 選擇組別模式**」下拉選單中選擇，程式會即時變更版面配置：

| 模式 | 桌型 | 排列矩陣 | 每組人數 | 特殊邏輯 |
| :---- | :---- | :---- | :---- | :---- |
| **6 組 (預設)** | **圓桌** | 2列 x 3行 | 6 人 | 適合大組討論，標準排列。 |
| **7 組** | **圓桌** | **2** \- 3 \- 2 交錯 | 5 人 | 強制換行邏輯，呈現第一列2桌、第二列3桌、第三列2桌的隊形。 |
| **8 組** | 方桌 | 2列 x 4行 | 5 人 | 適合長條型教室配置。 |
| **9 組** | 方桌 | 3列 x 3行 | 4 人 | 傳統九宮格分組。 |
| **20 組** | 方桌 | 5列 x 4行 | 2 人 | **左右並列**顯示 (1列2行)，適合考試或雙人討論。 |

* **隨機排列按鈕**：按下後，系統會清洗目前非鎖定的座位，並將名單隨機填入。若名單人數超過座位總數，會跳出警告。  
* **清空按鈕**：清除名單與座位上的學生，但**保留**已設定的「鎖定空位」。

### **第三步：互動操作 (模式切換)**

透過右側的開關切換兩種操作模式：

#### **1\. 點名/換位模式 (預設)**

* **點名**：點擊學生姓名框，會標記為 \<span style="color:red; background:\#fee2e2"\>紅色 (缺席)\</span\>，再次點擊取消。  
* **拖曳換位 (Drag & Drop)**：  
  * 按住學生姓名卡片，拖曳至另一個位子。  
  * 若目標位子有人：兩人交換。  
  * 若目標位子是空的：移動過去。  
  * *限制*：無法拖曳至「已鎖定」的位子。

#### **2\. 鎖定空位模式**

* **功能**：設定該座位「不排人」（顯示為灰色 **X**）。  
* **用途**：避開教室中的柱子、講台旁保留位、或損壞的桌椅。  
* **邏輯**：當執行「隨機排列」時，系統會**完全避開**這些鎖定的格子，只將學生填入剩餘的有效空位。

### **第四步：資料匯出**

* **下載座位表 (.doc)**：  
  * 產生 Microsoft Word 格式檔案。  
  * **排版保留**：程式會嘗試在 Word 表格中模擬網頁上的排列（例如 7 組模式會嘗試呈現 2-3-2 的空間感）。  
  * 包含：標題、列印時間、講台方向示意圖、缺席名單摘要。  
* **下載名單 (.xls)**：  
  * 產生 Excel 表格。  
  * 欄位包含：組別、學號、姓名、原始資料、狀態（出席/缺席）。  
  * 學號欄位經過特殊處理，避免 Excel 自動移除開頭的 0。

## **技術補充**

* **資料隱私**：所有運算皆在瀏覽器端 (Client-side) 執行，資料不會上傳至任何伺服器，關閉分頁後資料即消失。  
* **時間顯示**：右上角時鐘即時更新，匯出時會自動押上當下的時間戳記，方便存證。  
* **列印優化**：CSS 包含 @media print 設定，直接使用瀏覽器列印功能時，會自動隱藏操作面板，只列印座位表區域。
